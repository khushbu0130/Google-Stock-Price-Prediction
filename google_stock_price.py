# -*- coding: utf-8 -*-
"""Google Stock Price.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/18cYpGKi7Pvi4UbFYhvj5fOFgBzknQqY3
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import pandas_datareader as web
import warnings
!pip install prophet
from prophet import Prophet

import pandas as pd

data = pd.read_excel("/content/Dataset.xlsx")

# Manually parse the single column into multiple columns
data = data['Date,Open,High,Low,Close,Adj Close,Volume'].str.split(',', expand=True)

# Assign column names
data.columns = ['Date', 'Open', 'High', 'Low', 'Close', 'Adj Close', 'Volume']

# Convert 'Close' column to numeric
data['Close'] = pd.to_numeric(data['Close'])

data.head()

print(data.columns.tolist())

plt.style.use("fivethirtyeight")
plt.figure(figsize=(16,8))
plt.title("Google Closing Stock Price")
plt.plot(data["Close"])
plt.xlabel("Date", fontsize=18)
plt.ylabel("Close Price USD ($)", fontsize=18)
plt.show()

data = data[["Date","Close"]]
data = data.rename(columns = {"Date":"ds","Close":"y"})
data.head()

!pip install prophet

from prophet import Prophet

m = Prophet(daily_seasonality=True)
m.fit(data)

future = m.make_future_dataframe(periods=365)
predictions=m.predict(future)
m.plot(predictions)
plt.title("Prediction of GOOGLE Stock Price")
plt.xlabel("Date")
plt.ylabel("Closing Stock Price")
plt.show()

m.plot_components(predictions)
plt.show()